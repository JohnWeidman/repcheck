{% extends "base.html" %}
{% block content %}
    {% load congress_extras %}
    <div class="flex flex-col items-center h-full mx-auto p-4 rounded-lg">
        <div class="flex flex-col badge-xl bg-zinc-100 bg-opacity-70 m-10 rounded-lg p-4 drop-shadow-xl shadow-black w-screen md:w-3/4">
            <div class="hero">
                <div class="hero-content flex-col md:flex-row w-full">
                    <img src="{{ member.image_url }}"
                         width=""
                         height=""
                         class="w-48 md:w-64 lg:w-80 max-w-full rounded-lg shadow-2xl"
                         alt="{{ member.full_name }}" />
                    <div class="flex flex-col items-center md:items-start">
                        <div class="flex md:flex-row flex-col items-center md:items-start gap-5">
                            <h1 class="md:text-5xl text-2xl font-bold">{{ member.full_name }}</h1>
                            <div class="badge rounded-full w-12 h-12 text-slate-100 {% if most_recent_membership.party == 'Democratic' %}badge-primary{% elif most_recent_membership.party == 'Republican' %}badge-accent{% else %}badge-neutral{% endif %}">
                                {{ most_recent_membership.party|slice:":1" }}
                            </div>
                        </div>
                    <p class="py-6 md:w-3/4">
                        {{ member.full_name }}
                        {% if current %}
                            is currently
                        {% else %}
                            was most recently
                        {% endif %}
                        a {{ most_recent_membership.party }} member of the {{ most_recent_membership.chamber }} from
                        {% if most_recent_membership.district and most_recent_membership.chamber == "House of Representatives" %}
                            the {{ most_recent_membership.district|ordinal }} district of
                        {% endif %}
                        {{ member.state }}, and
                        {% if current %}has{% endif %}
                        served from {{ memberships.first_year }} to
                        {% if most_recent_membership.end_year == None %}
                            present.
                        {% else %}
                            {{ most_recent_membership.end_year }}.
                        {% endif %}
                    </p>
                    <button class="btn btn-primary bg-opacity-80" onclick="my_modal_4.showModal()">Contact & Links</button>
                    <dialog id="my_modal_4" class="modal">
                        <div class="modal-box md:w-3/4 w-11/12 max-w-4xl bg-zinc-100">
                            <div class="flex flex-col gap-8 p-4 mt-10">
                                {% if current %}
                                    <div class="flex-1">
                                        <h3 class="text-3xl font-bold mb-2">Contact Information:</h3>
                                        <ul>
                                            <li>
                                                Phone: <a href="tel:{{ member_details.phone_number }}">{{ member_details.phone_number }}</a>
                                            </li>
                                            {% if member_details.website_url %}
                                                <li>
                                                    <a href="{{ member_details.website_url }}"
                                                       target="_blank"
                                                       class="underline">{{ member.full_name }}'s website</a>
                                                </li>
                                            {% endif %}
                                        </ul>
                                    </div>
                                    {% if member_details.facebook_url or member_details.instagram_url or member_details.twitter_url or member_details.youtube_url %}
                                        <div class="flex-1">
                                            <h3 class="text-3xl font-bold mb-2">Social Media:</h3>
                                            <ul>
                                                {% if member_details.twitter_url %}
                                                    <li>
                                                        <a href="{{ member_details.twitter_url }}"
                                                           target="_blank"
                                                           class="underline">X</a>
                                                    </li>
                                                {% endif %}
                                                {% if member_details.facebook_url %}
                                                    <li>
                                                        <a href="{{ member_details.facebook_url }}"
                                                           target="_blank"
                                                           class="underline">Facebook</a>
                                                    </li>
                                                {% endif %}
                                                {% if member_details.instagram_url %}
                                                    <li>
                                                        <a href="{{ member_details.instagram_url }}"
                                                           target="_blank"
                                                           class="underline">Instagram</a>
                                                    </li>
                                                {% endif %}
                                                {% if member_details.youtube_url %}
                                                    <li>
                                                        <a href="{{ member_details.youtube_url }}"
                                                           target="_blank"
                                                           class="underline">YouTube</a>
                                                    </li>
                                                {% endif %}
                                            </ul>
                                        </div>
                                    {% endif %}
                                {% endif %}
                                <div class="flex-1">
                                    <h3 class="text-3xl font-bold mt-4">About:</h3>
                                    <p>
                                        <a href="{{ member_details.wikipedia_url }}"
                                           target="_blank"
                                           class="underline">Wikipedia</a>
                                    </p>
                                    <p>
                                        <a href="https://bioguide.congress.gov/search/bio/{{ member.bioguide_id }}"
                                           target="_blank"
                                           class="underline">
                                            Bioguide
                                        </a>
                                    </p>
                                    {% if member_details.open_secrets_url %}
                                        <p>
                                            <a href="{{ member_details.open_secrets_url }}"
                                               target="_blank"
                                               class="underline">Open Secrets</a>
                                        </p>
                                    {% endif %}
                                </div>
                                <div class="modal-action w-full flex justify-end">
                                    <form method="dialog">
                                        <button class="btn btn-accent text-zinc-100">Close</button>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </dialog>
                </div>
            </div>
        </div>
        <div class="md:w-full">
            <div tabindex="0"
                 class="collapse collapse-arrow bg-zinc-100 md:w-full drop-shadow-lg shadow-black rounded-lg">
                <div class="w-screen md:w-full bg-info text-white collapse-title text-3xl font-bold flex justify-center items-center">Terms</div>
                <div class="collapse-content text-sm overflow-x-scroll">
                    <table class="table md:w-full overflow-x-scroll w-screen">
                        <thead class="text-black text-lg">
                            <tr>
                                <th></th>
                                <th>Congress</th>
                                <th>Chamber</th>
                                <th>Leadership Role</th>
                                <th>Sponsored Legislation Count</th>
                                <th>Cosponsored Legislation Count</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for membership in memberships %}
                                <tr class="hover text-lg">
                                    <td></td>
                                    <td>{{ membership.congress.congress_number }}</td>
                                    <td>{{ membership.chamber }}</td>
                                    <td>{{ membership.leadership_role }}</td>
                                    <td>{{ membership.sponsored_legislation_count }}</td>
                                    <td>{{ membership.cosponsored_legislation_count }}</td>
                                </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock content %}
